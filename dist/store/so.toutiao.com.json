{
  "name": "ä»Šæ—¥å¤´æ¡æœç´¢",
  "version": "0.7.2",
  "description": "ä»Šæ—¥å¤´æ¡æ’ä»¶æœåŠ¡ï¼Œæä¾›èµ„è®¯å†…å®¹æœç´¢ç­‰å·¥å…·",
  "endpoint": "https://so.toutiao.com/openugc",
  "favicon": "https://so.toutiao.com/favicon.ico",
  "id": "so.toutiao.com",
  "tools": [
    {
      "name": "æœç´¢å¤´æ¡èµ„è®¯",
      "description": "ä½¿ç”¨å…³é”®è¯æœç´¢ç›¸å…³å¤´æ¡èµ„è®¯åˆ—è¡¨",
      "args": {
        "keyword": {
          "type": "string",
          "default": "",
          "description": "è¦æœç´¢çš„å…³é”®è¯",
          "required": true
        },
        "count": {
          "type": "number",
          "default": 10,
          "description": "è¦è·å–çš„æœç´¢ç»“æœæ•°é‡"
        }
      },
      "execute": "async (args) => {\n  let { keyword, count }= args;\n  count = count ? count : 10;\n  const search = async(page = 1) => new Promise((RES, REJ) => {\n    // const url = `https://cn.bing.com/search?q=${encodeURIComponent(keyword)}&first=${(page - 1) * 10}`;\n    const url = `https://so.toutiao.com/search?dvpf=pc&source=search_subtab_switch&keyword=${encodeURIComponent(keyword)}&pd=information&action_type=search_subtab_switch&page_num=${page - 1}&search_id=&from=news&cur_tab_title=news`;\n    const dom = document.createElement('iframe');\n    dom.style = 'display:none';\n    dom.src = url;\n    dom.onload = () => {\n      try {\n        const _result = Array.from(dom.contentDocument.querySelectorAll('[data-i]')).map(d => ({\n          title: d.querySelector('.cs-header > div > a').innerText,\n          desc: d.querySelector('.cs-text > div > span').innerText,\n          link: decodeURIComponent(d.querySelector('.cs-header > div > a').href.split('url=')[1]),\n          info: d.querySelector('.cs-source-content').innerText\n        }));\n        dom.remove();\n        return RES(_result);\n      } catch(e) {\n        REJ(`è§£ææ•°æ®å¤±è´¥ï¼š${e.message}`);\n      }\n    };\n    dom.onerror = REJ;\n    document.body.appendChild(dom);\n  });\n  const sleep = async(t = 1000) => new Promise(RES => setTimeout(RES, t));\n  return new Promise(async (RES, REJ) => {\n    let result = [];\n    let currentPage = 1;\n    while (count > result.length) {\n      let data;\n      try {\n        data = await search(currentPage);\n      } catch(e) {\n        return RES(e.message);\n      }\n      result = result.concat(data);\n      if (result.length >= count) {\n        RES(result.slice(0, count));\n        break;\n      }\n      currentPage += 1;\n      await sleep();\n    }\n  });\n}"
    }
  ],
  "hookJs": "window.onload = () => {\n  document.title = 'ğŸ¤– ä»Šæ—¥å¤´æ¡æœç´¢';\n  document.body.innerText = '[ä»Šæ—¥å¤´æ¡] OPENUGCä½¿ç”¨ä¸­';\n}"
}